!function(f){"use strict";function e(r,e,l,n){var i,d,o=l.option.maxboxUrl,t=l.option.maxboxAttrib,a=l.option.accessToken,s=l.option.defaultLat,u=l.option.defaultLong,c=(r.codeEnabled=!0,new Proxy(new URLSearchParams(window.location.search),{get:(e,o)=>e.get(o)})),c=c.id.replace(/\s/g,"+"),c=CryptoJS.AES.decrypt(c,"kNISDIqad91210201013lz821b").toString(CryptoJS.enc.Utf8);function m(e){var e=(e+"").split(".",2),o=e[1].substr(0,5),e=e[0]+"."+o;return parseFloat(e)}function g(e,o){r.model.address="",f.get("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat="+e+"&lon="+o,function(e){var o=e.address.building,t=e.address.road,a=", ",n=e.address.village+a+e.address.city+a+e.address.state+a+e.address.postcode+" "+e.address.country;e.address.amenity&&(o=e.address.amenity),r.$apply(()=>{r.model.address=null!=o&&null!=t?o+a+t+a+n:null!=o&&null==t?o+a+n:null==o&&null!=t?t+a+n:n})})}function p(e){var o,t;r.model.isHaveGeoPoint&&(d&&i.removeLayer(d),o=m(e.latlng.lat),t=m(e.latlng.lng),i.panTo(new L.LatLng(o,t)),(d=new L.marker([o,t],{draggable:!0})).on("dragend",v),d.addTo(i),d.bindPopup("<b>Alamat saya disini</b>.").openPopup(),r.model.isHaveGeoPoint)&&n(function(){r.model.latitude=o,r.model.longitude=t,g(o,t)},0)}function v(e){var o=e.target.getLatLng();n(function(){r.model.latitude=m(o.lat),r.model.longitude=m(o.lng)},0)}r.model=l.getLocalStorage(c),r.model.isHaveGeoPoint=!0,r.setMarker=function(e,o,t,a){r.model.isHaveGeoPoint&&(d&&i.removeLayer(d),r.model.latitude=m(e),r.model.longitude=m(o),i.panTo(new L.LatLng(e,o)),t&&i.flyTo(new L.LatLng(e,o),t),(d=new L.marker([r.model.latitude,r.model.longitude],{draggable:!0})).on("dragend",function(e){var o=e.target.getLatLng();n(function(){r.model.latitude=o.lat,r.model.longitude=o.lng},0)}),d.addTo(i),i.addLayer(d),g(r.model.latitude,r.model.longitude),(a?d.bindPopup("<b>Lokasi</b>. <br/>"+a):d.bindPopup("<b>Lokasi</b>. <br/>")).openPopup())},r.getCurrentLocation=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){r.model.latitude=e.coords.latitude,r.model.longitude=e.coords.longitude,r.setMarker(e.coords.latitude,e.coords.longitude,17,"lokasi saya")},function(e){l.Alert.error(e.message)}):l.Alert.error("Geolocation is not supported by this browser.")},r.convertLinkGoogleMaps=function(e){var o=e.originalEvent.clipboardData.getData("text/plain"),e=function(e){var o="",e=e.split("/")[5];e&&(e=e.split("+"),o=e.join(" "));return o}(o),t=/![34]d(-?[\d\.]+)/g,a=[],n=t.exec(o);if(null!=n){for(;null!==n;)a.push(n[1]),n=t.exec(o);1<a.length&&r.setMarker(a[0],a[1],17,e)}else l.Alert.error("location not found")},r.setmap=function(){i=new L.map("mapid").setView([s,u],11),L.tileLayer(o,{attribution:t,tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:a}).addTo(i),i.on("click",p)},n(function(){r.setmap()},0),r.model.paymentMethod="transfer",r.model.ongkir=0,r.model.grandTotal=r.model.subTotalCart+r.model.ongkir,r.choosePaymentMethod=function(e){r.model.paymentMethod=e,r.model.grandTotal=r.model.subTotalCart+r.model.ongkir},r.printDiv=function(){var t=f("#textAreaCopy").replaceWith("<div id='divForTACopy' class='divTextArea'>"+f("#textAreaCopy").val().replace(/\n/g,"<br>")+"</div>"),a=f("#textArea").replaceWith("<div id='divForTA' class='divTextArea'>"+f("#textArea").val().replace(/\n/g,"<br>")+"</div>");html2canvas(f("#DivIdToPrint")[0],{useCORS:!0,allowTaint:!1,ignoreElements:e=>"IFRAME"===e.nodeName}).then(e=>{f("#divForTACopy").replaceWith(t),f("#divForTA").replaceWith(a),f("#out_image").append(e);var o=document.createElement("a");o.href=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),o.download=r.model.name+"_"+r.model.orderDate+"_invoice.jpg",o.click()})}}angular.module("ummuza").controller("checkCtrl",e),e.$inject=["$scope","$http","farst","$timeout"]}(jQuery);