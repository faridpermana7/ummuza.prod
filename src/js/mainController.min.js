!function(m){"use strict";function t(r,t,s){var a,n,e,i,o,l,p="&range=B2:L100",u="https://docs.google.com/spreadsheets/d/1VcwB6bea0mf40hpTl8cI4ILD4HIZd0bu_tZfLAFbvOw/gviz/tq?sheet=",d=["menu","mix_menus","hampres_menus","frozen_menus","unggul","lates_post"];function h(t){for(var a=[],n=[],e=0;e<t.cols.length;e++)a.push(t.cols[e].label);for(e=0;e<t.rows.length;e++){for(var r={},s=0;s<a.length;s++)r[a[s]]=t.rows[e].c[s].v;n.push(r)}return n}function c(){r.subTotalCart=0,r.shoppingCarts.forEach(t=>{r.subTotalCart=r.subTotalCart+t.subPrice})}fetch(u+d[4]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));o=h(t.table),r.$apply(()=>{r.listunggul=o;m.param(o)})}),fetch(u+d[0]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));a=h(t.table),r.$apply(()=>{r.listMenu=a})}),fetch(u+d[1]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));n=h(t.table),r.$apply(()=>{r.listMixMenu=n})}),fetch(u+d[2]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));e=h(t.table),r.$apply(()=>{r.listHampresMenu=e})}),fetch(u+d[3]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));i=h(t.table),r.$apply(()=>{r.listFrozenMenu=i})}),fetch(u+d[5]+p).then(t=>t.text()).then(t=>{t=JSON.parse(t.substr(47).slice(0,-2));l=h(t.table),r.$apply(()=>{r.listLatesPost=l})}),r.cartQty=0,r.subTotalCart=0,r.addChart=[],r.shoppingCarts=[],r.model={},r.opts=s.singleDateFormat(s.l.DATEFORMAT),r.model.orderDate=s.l.getDate(),r.addToCart=async function(t,a){if(null!=a&&0<a){var n=[];switch(t){case"mix":n=_.find(r.listMixMenu,function(t){return t.id==a});break;case"ham":n=_.find(r.listHampresMenu,function(t){return t.id==a});break;case"froz":n=_.find(r.listFrozenMenu,function(t){return t.id==a});break;default:n=_.find(r.listMenu,function(t){return t.id==a})}if(0==n.stok)return s.Alert.error("Stok sudah habis, ditunggu ya");var e=(await Swal.fire({title:"Tambahkan Dimsum ke Keranjang",input:"number",inputLabel:n.title,inputPlaceholder:"Berapa pack?",inputAttributes:{min:1,max:50,step:1,pattern:"[0-9]{10}"},inputValidator:t=>50<t?"Maksimal pack adalah 50":t<=0?"Minimal order adalah 1 pack":void 0}))["value"];if(e){t=_.find(r.shoppingCarts,function(t){return t.id==a});for(let t=0;t<e;t++)r.addChart.push({id:a});s.Alert.success("Berhasil menambahkan "+n.title+" untuk "+e+" pack"),null==t&&r.$apply(()=>{r.cartQty++})}}},r.generateShoopingCart=function(){r.shoppingCarts=[];for(let t=0;t<r.addChart.length;t++){var a={},n=r.addChart[t].id,e=r.listMenu.concat(r.listMixMenu,r.listHampresMenu,r.listFrozenMenu),a=_.find(e,function(t){return t.id==n});null==_.find(r.shoppingCarts,function(t){return t.id==n})?(a.qty=1,a.subPrice=a.discountPrice,r.shoppingCarts.push(a)):(e=_.findIndex(r.shoppingCarts,function(t){return t.id==n}),r.shoppingCarts[e].qty++,r.shoppingCarts[e].subPrice=r.shoppingCarts[e].qty*r.shoppingCarts[e].discountPrice)}c()},r.addQtyItem=function(t,a){let n=_.findIndex(r.shoppingCarts,function(t){return t.id==a}),e=_.findIndex(r.addChart,function(t){return t.id==a});"add"==t?50==r.shoppingCarts[n].qty?s.Alert.error("Maximal order adalah 50 pack"):(r.shoppingCarts[n].qty++,r.shoppingCarts[n].subPrice=r.shoppingCarts[n].qty*r.shoppingCarts[n].discountPrice):1==r.shoppingCarts[n].qty?s.Alert.confirm("Hapus dimsum","Apakah anda yakin menghapus order ini?",function(t){t.isConfirmed&&(1<r.shoppingCarts.length?r.$apply(()=>{r.shoppingCarts.splice(n,1),r.addChart.splice(e,1),r.cartQty--}):r.$apply(()=>{r.shoppingCarts=[],r.addChart=[],r.cartQty=0,r.subTotalCart=0,r.model={}}))}):(r.addChart.splice(e,1),r.shoppingCarts[n].qty--,r.shoppingCarts[n].subPrice=r.shoppingCarts[n].qty*r.shoppingCarts[n].discountPrice),c()},r.checkOut=function(){r.model.shoppingCarts=[],r.model.shoppingCarts=r.shoppingCarts,r.model.subTotalCart=r.subTotalCart;var t,a=null==r.model.orderDate?"Tolong masukkan tanggal pemesanan":null==r.model.name?"Tolong masukkan nama anda":null==r.model.noHp?"Tolong masukkan nomor anda (yang terhubung dengan WA)":0==r.shoppingCarts.length?"Anda belum ada masukkan pesanan dimsum, silahkan tambah terlebih dahulu.":0==s.validasiNomorSeluler(r.model.noHp)?"Format nomor yang anda masukkan salah. Pastikan nomor anda aktif dan terdaftar provider di Indonesia.":"";a?s.Alert.error(a):(a=(Math.random()+1).toString(36).substring(2),s.setLocalStorage(a,r.model),a=CryptoJS.AES.encrypt(a,"kNISDIqad91210201013lz821b"),t=window.location.origin,window.location.href=t+"/checkout.html?id="+a)}}angular.module("ummuza").controller("mainCtrl",t),t.$inject=["$scope","$http","farst"]}(jQuery);