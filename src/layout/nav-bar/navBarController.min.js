!function(){"use strict";function a(o,t,s,a,e){var i=this;function p(){i.subTotalCart=0,i.shoppingCarts.forEach(a=>{i.subTotalCart=i.subTotalCart+a.subPrice})}return i.cartQty=0,i.subTotalCart=0,i.addChart=[],i.shoppingCarts=[],i.listMenu=[],i.listMixMenu=[],i.listHampresMenu=[],i.listFrozenMenu=[],i.model={},i.opts=s.singleDateFormat(s.l.DATEFORMAT),i.model.orderDate=s.l.getDate(),e.$on("sendToNavbar",function(a,t){o.info=!0,o.$apply(()=>{i.cartQty=t.cartQty,i.addChart=t.addChart,i.listMenu=t.listMenu,i.listMixMenu=t.listMixMenu,i.listHampresMenu=t.listHampresMenu,i.listFrozenMenu=t.listFrozenMenu})}),i.generateShoopingCart=function(){i.shoppingCarts=[];for(let a=0;a<i.addChart.length;a++){var t={},n=i.addChart[a].productMenuId,r=i.listMenu.concat(i.listMixMenu,i.listHampresMenu,i.listFrozenMenu),t=_.find(r,function(a){return a.productMenuId==n});null==_.find(i.shoppingCarts,function(a){return a.productMenuId==n})?(t.qty=1,t.subPrice=t.discountPrice,i.shoppingCarts.push(t)):(r=_.findIndex(i.shoppingCarts,function(a){return a.productMenuId==n}),i.shoppingCarts[r].qty++,i.shoppingCarts[r].subPrice=i.shoppingCarts[r].qty*i.shoppingCarts[r].discountPrice)}p()},i.addQtyItem=function(a,t){let n=_.findIndex(i.shoppingCarts,function(a){return a.productMenuId==t}),r=_.findIndex(i.addChart,function(a){return a.productMenuId==t});"add"==a?50==i.shoppingCarts[n].qty?s.Alert.error("Maximal order adalah 50 pack"):(i.shoppingCarts[n].qty++,i.shoppingCarts[n].subPrice=i.shoppingCarts[n].qty*i.shoppingCarts[n].discountPrice):1==i.shoppingCarts[n].qty?s.Alert.confirm("Hapus dimsum","Apakah anda yakin menghapus order ini?",function(a){a.isConfirmed&&(1<i.shoppingCarts.length?o.$apply(()=>{i.shoppingCarts.splice(n,1),i.addChart.splice(r,1),i.cartQty--}):o.$apply(()=>{i.shoppingCarts=[],i.addChart=[],i.cartQty=0,i.subTotalCart=0,i.model={}}),e.$broadcast("sendToMenu",{cartQty:i.cartQty,addChart:i.addChart,shoppingCarts:i.shoppingCarts}))}):(i.addChart.splice(r,1),i.shoppingCarts[n].qty--,i.shoppingCarts[n].subPrice=i.shoppingCarts[n].qty*i.shoppingCarts[n].discountPrice),p()},i.checkOut=function(){i.model.shoppingCarts=[],i.model.shoppingCarts=i.shoppingCarts,i.model.subTotalCart=i.subTotalCart;var a=null==i.model.orderDate?"Tolong masukkan tanggal pemesanan":null==i.model.name?"Tolong masukkan nama anda":null==i.model.noHp?"Tolong masukkan nomor anda (yang terhubung dengan WA)":0==i.shoppingCarts.length?"Anda belum ada masukkan pesanan dimsum, silahkan tambah terlebih dahulu.":0==s.validasiNomorSeluler(i.model.noHp)?"Format nomor yang anda masukkan salah. Pastikan nomor anda aktif dan terdaftar provider di Indonesia.":"";a?s.Alert.error(a):(a=(Math.random()+1).toString(36).substring(2),s.setLocalStorage(a,i.model),a=CryptoJS.AES.encrypt(a,"kNISDIqad91210201013lz821b"),t.go("app.pages.checkout",{id:a}),$("#shoppingCartModal").modal("toggle"))},i.changeMenu=function(a){i.bar=a},i}angular.module("ummuza").controller("navBarCtrl",a),a.$inject=["$scope","$state","farst","HttpService","$rootScope"]}();