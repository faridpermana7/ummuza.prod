!function(){"use strict";function e(e,t,a,l,r,i,s,u,n,o,d){var m,c,b=this,f=(b.ui={},b.status=100,b.memberId=0,b.parentMemberId=100,b.isVisibleMember=!0,{});function p(e,t,a,l){var r='<button class="btn btn-default" rel="tooltip" title="Edit" ng-click="usr.ui.edit('+e.userId+')">   <i class="fa fa-edit"></i></button>&nbsp;',i='<button class="btn btn-default" rel="tooltip" title="Delete" ng-click="usr.ui.delete('+e.userId+')">   <i class="fa fa-times"></i></button>&nbsp;';return"Courier"!=e.roleName?r+i:r}function v(e,t,a,l){return e?s.l.toLocaleDateStr(s.l.toDatetimeUTC(e).toString(),s.l.DATETIME_FORMAT):"-"}function g(e){e&&e.reload&&b.reloadData()}return f.ids=[],b.dtCallback=function(e){b.datatable=e.DataTable},b.ui.search=function(){b.datatable.search(b.Keyword).draw()},b.ui.clear=function(){b.username=void 0,b.fullName=void 0,b.roleName=void 0,b.status=void 0,b.memberId=void 0,b.listMember=void 0},b.ui.filter=function(){var e=[];b.username&&e.push({field:"username",operator:"=",value:b.username}),b.fullName&&e.push({field:"fullName",operator:"=",value:b.fullName}),b.roleName&&e.push({field:"roleName",operator:"=",value:b.roleName}),null!=b.status&&100!=b.status&&e.push({field:"isActive",operator:"=",value:b.status}),null!=b.memberId&&0!=b.memberId&&1==b.isVisibleMember&&e.push({field:"memberId",operator:"=",value:b.memberId}),f.filters=e,b.dtService.param=f,b.datatable.draw()},b.getMemberList=function(e){d.post("/members/get-list",{keyword:e,pageSize:10,filters:[{field:"parentId",operator:"=",value:b.parentMemberId}]}).then(function(e){b.listMember=e.data.data.records})},b.ui.add=function(){t.go("app.sys.user-entry",{id:"new"})},b.ui.edit=function(e){t.go("app.sys.user-entry",{id:e})},b.ui.delete=function(e){i.deleteUser({Id:e},b.datatable)},e.$on("ui.layout.resize",function(e,t,a){b.datatable.columns.adjust()}),e.$on("ui.layout.toggle",function(e,t){setTimeout(function(){b.datatable.columns.adjust()},700)}),e.$on("$destroy",function(){n.unregisterCallback(b.logKey),u.cancelAll()}),b.logKey="",b.init=(e=e,m=n,s.loadingIn(),c=a.localStorage.getItem("user"),l(function(){null!=(c=JSON.parse(c)).parentMemberName&&(b.isVisibleMember=!1),b.parentMemberId=c.memberId,b.getMemberList()},0),b.logKey=m.registerCallback(g,!0),b.dtService=r.getService(),b.dtOptions=b.dtService.initTable(e,"/users/get-list",{route:"app.user-entry",fixedColumn:[3,1]},"userId",!1,null,null,{onStateSaveParam:function(e){e.statusFilter=b.status,e.memberFilter=b.memberId},onStateLoadCallback:function(e){e&&(b.Keyword=e.search.search,b.status=e.statusFilter,b.memberId=e.memberFilter)}}),b.dtColumns=b.dtService.setColumn([{data:"userId",className:"text-center"},{data:"username"},{data:"fullName"},{data:"roleName",className:"text-center"},{data:"memberName",className:"text-center"},{data:"status",className:"text-center"},{data:"updatedBy",className:"text-center"},{data:"updatedDate",render:v},{data:null,title:"",render:p,className:"text-center"}]),b.isCollapsed=!0,b.isCollapsed=!0,b.statusParam=[{value:100,label:"All"},{value:1,label:"Active"},{value:0,label:"Suspend"}],b.listBranch=[{value:100,label:"All"},{value:1,label:"BCPA"},{value:2,label:"BCPJ"}],void s.loadingOut()),b}angular.module("ummuza").controller("userCtrl",e),e.$inject=["$scope","$state","$window","$timeout","datatableService","userEntryService","farst","pendingRequest","modalLoginService","ConfigService","HttpService"]}();